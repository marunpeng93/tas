(function(r,f){if(typeof define==='function'&&define.amd){define(function(){return f(r,r.document)})}else if(typeof exports==='object'){module.exports=r.document?f(r,r.document):function(w){return f(w,w.document)}}else{r.tas=f(r,r.document)}}(typeof window!=='undefined'?window:this,function(window,document){return function(n){function t(o){if(e[o])return e[o].exports;var i=e[o]={exports:{},id:o,loaded:!1};return n[o].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var e={};t.m=n,t.c=e,t.p="",t(0)}([function(n,t,e){n.exports=e(1)},function(n,t,e){var o=e(2),i=e(4),a=e(7),s=e(6),r=e(8),c=e(9),u=e(10),l=function(n){if(u.is())u.do(n);else if(s.isAbort())return;i.add(n)};l.await=function(n){u.is()&&u.do(n),n.isAwait=!0,i.add(n)},l.promise=function(n){l.await(n)},l.next=function(n,t){var e=arguments.length;2===e?a.save2(n,t):1===e?a.save1(arguments[0]):0===e?a.save0():a.saveArray([].slice.call(arguments)),o.next()},l.resolve=function(n,t){a.save2(n,t),o.next()},l.break=function(){c.do()},l.abort=function(n){r.do(n)},l.begin=function(){u.set()},l.load=function(){var n=e(11);return n.init(l),n.load([].slice.call(arguments)),l},l.unload=function(){return e(11).unload([].slice.call(arguments)),l},n.exports=l},function(n,t,e){var o,i,a=e(3),s=(e(4),e(5)),r=e(7),c=e(6),u=e(8),l=e(9),f={exec:function(n){var t=a.flag;if(!t.isAwait)for(var e,o,i=f.runFunc;(e=n.shift())&&(o=i(e),!t.isAwait);)if("await"===o||!0===e.isAwait){t.isAwait=!0;break}},execFunc:function(n){var t=a.flag;if(!t.isAwait){"await"!==f.runFunc(n)&&!0!==n.isAwait||(t.isAwait=!0)}},runFunc:function(n){var t=a.extensions.isForEachEnabled;a.extensions.isTreeEnabled&&o.tree.print(n),a.maxLayer=a.layer,a.layer++;var e=a.pass,s=e.isHasArgs?n.apply(null,e):n();return t&&n.isTheLastFunc&&n.root.isForEach?i.loop():void 0===s?r.save0():Array.isArray(s)?r.save(s):"break"===s?l.do():"abort"===s?u.do():"continue"===s?i.continue():r.save1(s),a.layer>0&&a.layer--,s},next:function(){var n,t,e=a,o=e.flag,r=e.extensions.isForEachEnabled,u=e.maxLayer;for(o.isAwait=!1;u>=0;){if(e.layer=u,e.units[u]&&e.units[u].length&&f.exec(e.units[u]),void 0!==(t=e.tasks[u]))for(;!o.isAwait&&(n=t.shift());)o.isAwait=!1,"function"==typeof n?f.execFunc(n):r&&!0===n.isForEach?i.exec(n):s.do(n);u--}e.tasks[0]&&!e.tasks[0].length&&c.setIsAwait(!1)},saveTas:function(n){o=n},saveForEach:function(n){i=n}};n.exports.__proto__=f},function(n,t){var e={layer:0,maxLayer:0,tasks:{},units:{},pass:[],flag:{isAwait:!1,isAbort:!1},extensions:{isPromiseAllEnabled:!1,isPromiseRaceEnabled:!1,isForEachEnabled:!1,isTreeEnabled:!1}};n.exports=e},function(n,t,e){var o=e(3),i=e(2),a=e(5),s=(e(6),{add:function(n){var t=o,e=t.flag,s=typeof n;"function"!==s||t.layer||e.isAwait?("object"===s&&!n.isTheLastFunctionMarked&&this.markTheLastFunction(n),this.addToLayer(n),!e.isAwait&&a.do(t.tasks[t.layer].shift())):i.execFunc(n)},addToLayer:function(n){var t=o,e=t.layer,i=t.tasks;n.layer=e,void 0===i[e]&&(i[e]=[]),i[e].push(n)},markTheLastFunction:function(n){for(var t,e=Object.keys(n),o=e.length-1;o>=0&&"function"!=typeof(t=n[e[o]]);o--);t.isTheLastFunc=!0,n.isTheLastFunctionMarked=!0},clearTheRemainingTasks:function(){var n,t,e=o,i=e.maxLayer;for(t=i;t>=0;t--)e.units[t]&&(e.units[t].length=0);for(t=i;t>0;t--)e.tasks[t]&&(e.tasks[t].length=0);for(n=e.tasks[0];n&&n.length&&!n[0].isFirst;)n.shift()}});n.exports.__proto__=s},function(n,t,e){var o,i=e(3),a=e(2),s={},r={do:function(n){this.add(n);var t=i.units[n.layer];t&&t.length&&a.exec(t)},add:function(n){var t=i,e=n.layer||0;s.layer=e,s.root=n,void 0===t.units[e]&&(t.units[e]=[]);var a=t.units[e],r=i.extensions.isTreeEnabled;r&&o.tree.nested.createFnForBegin(a);var c=n;if("function"==typeof n){var u={};u[n.name]=n,u.isAwait=n.isAwait,c=u}this.getAllFunctions(e,c,c,c.isAwait,a,0),r&&o.tree.nested.createFnForEnd(a)},getAllFunctions:function n(t,e,a,s,r,c){for(var u,l,f=Object.keys(a),d=i.extensions.isTreeEnabled,v=0,p=f.length;v<p;v++)u=f[v],l=a[u],"object"==typeof l?(d&&o.tree.nested.createFnForAdd(u,r,c),n(t,e,l,s,r,c+1),d&&o.tree.nested.createFnForSub(r,c)):"function"==typeof l&&(l.root=e,l.layer=t,l.isAwait=s,r.push(l),d&&(l.treeBranch=u),d&&(l.treeIndent=o.tree.nested.getCount()+c))},clearTheRemainingFunctions:function(){for(var n=i,t=s.layer,e=s.root,o=n.units[t],a=0,r=o.length;a<r;a++)o[a]&&o[a].root===e&&o.shift()},saveTas:function(n){o=n}};n.exports.__proto__=r},function(n,t,e){var o=e(3),i={isAbort:function(){return o.flag.isAbort},setIsAbort:function(n){o.flag.isAbort=n},setIsAwait:function(n){o.flag.isAwait=n}};n.exports.__proto__=i},function(n,t,e){var o=e(3),i={save:function(n){var t=n.length;2===t?this.save2(n[0],n[1]):1===t?this.save1(n[0]):0===t?this.save0():this.saveArray(n)},save0:function(){var n=o;n.pass[0]=void 0,n.pass[1]=void 0,n.pass.isHasArgs=!1},save1:function(n){var t=o;t.pass[0]=n,t.pass[1]=void 0,t.pass.isHasArgs=!0},save2:function(n,t){var e=o;e.pass[0]=n,e.pass[1]=t,e.pass.isHasArgs=!0},saveArray:function(n){var t=o;t.pass=n,t.pass.isHasArgs=!0},reset:function(){o.pass.length=0,o.pass.isHasArgs=!1}};n.exports.__proto__=i},function(n,t,e){var o=e(4),i=e(7),a=e(2),s=e(6),r={do:function(n){n&&console.log(n),o.clearTheRemainingTasks(),i.reset(),a.next(),s.setIsAbort(!0)}};n.exports.__proto__=r},function(n,t,e){var o=e(5),i={do:function(){o.clearTheRemainingFunctions()}};n.exports.__proto__=i},function(n,t,e){var o=e(6),i={f:!1,do:function(n){return this.f=!1,n.isFirst=!0,o.setIsAbort(!1),n},is:function(){return this.f},set:function(){this.f=!0}};n.exports=i},function(n,t,e){var o,i={isUnload:!1,init:function(n){o=n},load:function(n){1===n.length?i.loadExtension(n[0]):i.loadExtensions(n)},loadExtensions:function(n){n.forEach(function(n){i.loadExtension(n)})},loadExtension:function(n){var t=e(12)("./"+n);i.isUnload?t.unload&&t.unload():t.init(o)},unload:function(n){i.isUnload=!0,i.load(n),i.isUnload=!1}};n.exports.__proto__=i},function(n,t,e){function o(n){return e(i(n))}function i(n){return a[n]||function(){throw new Error("Cannot find module '"+n+"'.")}()}var a={"./forEach":13,"./forEach.js":13,"./loader":11,"./loader.js":11,"./promise-all":14,"./promise-all.js":14,"./promise-race":16,"./promise-race.js":16,"./promise~util":15,"./promise~util.js":15,"./tree":17,"./tree.js":17};o.keys=function(){return Object.keys(a)},o.resolve=i,n.exports=o,o.id=12},function(n,t,e){var o,i,a,s=e(3),r=e(2),c=e(4),u=e(5),l=e(7),f=0,d={init:function(n){o=n,r.saveForEach(this),o.forEach=this.forEach,o.continue=this.continue,s.extensions.isForEachEnabled=!0},unload:function(){s.extensions.isForEachEnabled=!1,o.forEach=null,o.continue=null},forEach:function(n){n.isForEach=!0,c.markTheLastFunction(n),s.flag.isAwait?c.add(n):d.exec(n)},exec:function(n){i=s.pass[0].slice(),a=n,f=0,d.loop()},loop:function(){for(var n=s,t=n.flag;!t.isAwait&&i.length;)n.layer++,l.save2(i.shift(),f++),c.add(a),n.layer--},continue:function(){u.clearTheRemainingFunctions(),d.loop()}};n.exports.__proto__=d},function(n,t,e){var o,i=e(3),a=e(15),s={init:function(n){o=n,o.all=this.all,i.extensions.isPromiseAllEnabled=!0},unload:function(){i.extensions.isPromiseAllEnabled=!1,o.all=null},all:function(n){var t=Object.keys(n).length,e=0,i=[],s={done:function(n,a){e++,i.push(a),(n||e===t)&&o.resolve(n,i)},abort:function(){o.abort(),this.done("abort")}};o.await(a.convert(n,s))}};n.exports.__proto__=s},function(n,t){var e={convert:function(n,t){return function(){for(var e=Object.keys(n),o=0;o<e.length;o++)n[e[o]].call(t)}}};n.exports.__proto__=e},function(n,t,e){var o,i=e(3),a=e(6),s=e(15),r={init:function(n){o=n,o.race=this.race,o.cancel=this.cancel,i.extensions.isPromiseRaceEnabled=!0},unload:function(){i.extensions.isPromiseRaceEnabled=!1,o.race=null,o.cancel=null},race:function(n){var t=0,e={done:function(n,e){1==++t&&o.resolve(n,e)},abort:function(){a.setIsAwait(!1),o.abort()}};o.await(s.convert(n,e))},cancel:function(n){n&&n instanceof Array&&n.forEach(function(n){n.abort?"undefined"!=typeof XMLHttpRequest&&n instanceof XMLHttpRequest?n.readyState!==XMLHttpRequest.UNSENT&&n.abort():n.abort():clearTimeout(n)})}};n.exports.__proto__=r},function(n,t,e){(function(t){var o,i=e(3),a=e(2),s=e(5),r={count:0,add:function(){r.count++},sub:function(){r.count--},getCount:function(){return r.count},createFnForBegin:function(n){var t=function(){r.add()};t.__isIgnore=!0,n.push(t)},createFnForEnd:function(n){var t=function(){r.sub()};t.__isIgnore=!0,n.push(t)},createFnForAdd:function(n,t,e){var o=function(){r.add()};o.treeIndent=r.getCount()+e,o.__isIgnore=!0,o.__realName=n,t.push(o)},createFnForSub:function(n,t){var e=function(){!i.flag.isAwait&&r.sub()};e.treeIndent=r.getCount()+t,e.__isIgnore=!0,n.push(e)},reset:function(){r.count=0}},c={lastTreeIndent:0,getStr:function(n){var t=c.lastTreeIndent+1+(void 0===n?0:n),e=f.repeat(" ",4*(t-1));return("  "+t).substr(-2)+"|"+e},reset:function(){c.lastTreeIndent=0}},u={data:[],isSaveToArr:!1,begin:function(){u.isSaveToArr=!0,u.data.length=0},save:function(n){u.data.push(n)},getStr:function(){return u.data.join("\n")},reset:function(){u.data.length=0,u.isSaveToArr=!1}},l={init:function(n){o=n,a.saveTas(o),s.saveTas(o),o.tree=this,o.tree.logArray=u,o.tree.nested=r,i.extensions.isTreeEnabled=!0},unload:function(){i.extensions.isTreeEnabled=!1,o.tree=null,r.reset(),c.reset(),u.reset()},print:function(n){var t=n.__isIgnore?n.__realName:n.treeBranch||n.name;if(t){void 0!==n.treeIndent&&(c.lastTreeIndent=n.treeIndent);var e=c.getStr();f.log(e,t)}},log:function(){var n=[].slice.call(arguments),t=c.getStr(1);n.unshift(t),f.log.apply(null,n)}},f={log:function(){var n=[].slice.call(arguments);if(u.isSaveToArr)u.save(n[0]+" "+n[1]);else{!("object"==typeof t&&!0===t.isDisabledLog||"object"==typeof window&&!0===window.global.isDisabledLog)&&console.log.apply(console,n)}},repeat:function(n,t){return new Array(t+1).join(n)}};n.exports.__proto__=l}).call(t,function(){return this}())}]);}));